{
"version":3,
"file":"goog.html.cssspecificity.js",
"lineCount":67,
"mappings":"AAQA,IAAA,CAAA,UAAA,CAAA,QAAA,CAAA,OAAA,CAAA;AAAA,cAAA;AAAAA,MAAKC,CAAAA,MAAL,CAAY,0BAAZ,CAAA;AACAD,MAAKC,CAAAA,MAAOC,CAAAA,sBAAZ,EAAA;AAEA,MAAIC,YAAYH,IAAKI,CAAAA,OAAL,CAAa,gBAAb,CAAhB;AACA,MAAIC,mBAAmBL,IAAKI,CAAAA,OAAL,CAAa,wBAAb,CAAvB;AAOA,MAAIE,mBAAmB,EAAvB;AAWAC,UAASA,eAAc,CAACC,QAAD,CAAW;AAChC,QAAIH,gBAAiBI,CAAAA,EAArB,IAA2B,CAACN,SAAUO,CAAAA,iBAAV,CAA4B,CAA5B,CAA5B;AAEE,aAAO,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,CAAP;AAFF;AAIA,QAAIC,cAAcL,gBAAiBM,CAAAA,cAAjB,CAAgCJ,QAAhC,CAAA,GACdF,gBAAA,CAAiBE,QAAjB,CADc,GAEd,IAFJ;AAGA,QAAIG,WAAJ;AACE,aAAOA,WAAP;AADF;AAGA,QAAIE,MAAOC,CAAAA,IAAP,CAAYR,gBAAZ,CAA8BS,CAAAA,MAAlC,GAA4C,CAA5C,IAAiD,EAAjD;AAGET,sBAAA,GAAmB,EAAnB;AAHF;AAKAK,eAAA,GAAcK,oBAAA,CAAqBR,QAArB,CAAd;AACAF,oBAAA,CAAiBE,QAAjB,CAAA,GAA6BG,WAA7B;AACA,WAAOA,WAAP;AAlBgC;AA6BlCM,UAASA,qBAAoB,CAACT,QAAD,EAAWG,WAAX,EAAwBO,KAAxB,EAA+BC,SAA/B,CAA0C;AACrE,WAAOX,QAASY,CAAAA,OAAT,CAAiBF,KAAjB,EAAwB,QAAQ,CAACG,KAAD,CAAQ;AAC7CV,iBAAA,CAAYQ,SAAZ,CAAA,IAA0B,CAA1B;AAGA,aAAOG,KAAA,CAAMD,KAAMN,CAAAA,MAAZ,GAAqB,CAArB,CAAwBQ,CAAAA,IAAxB,CAA6B,GAA7B,CAAP;AAJ6C,KAAxC,CAAP;AADqE;AAgBvEC,UAASA,qBAAoB,CAAChB,QAAD,EAAWU,KAAX,CAAkB;AAC7C,WAAOV,QAASY,CAAAA,OAAT,CAAiBF,KAAjB,EAAwB,QAAQ,CAACG,KAAD,CAAQ;AAC7C,aAAOC,KAAA,CAAMD,KAAMN,CAAAA,MAAZ,GAAqB,CAArB,CAAwBQ,CAAAA,IAAxB,CAA6B,GAA7B,CAAP;AAD6C,KAAxC,CAAP;AAD6C;AAc/CP,UAASA,qBAAoB,CAACR,QAAD,CAAW;AACtC,QAAIG,cAAc,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,CAAlB;AAOA,QAAIc,yBAAyB,IAAIC,MAAJ,CAAW,wBAAX,EAAqC,GAArC,CAA7B;AAGA,QAAIC,0BAA0B,IAAID,MAAJ,CAAW,yBAAX,EAAsC,GAAtC,CAA9B;AAEA,QAAIE,yBAAyB,MAA7B;AACApB,YAAA,GAAWgB,oBAAA,CAAqBhB,QAArB,EAA+BiB,sBAA/B,CAAX;AACAjB,YAAA,GAAWgB,oBAAA,CAAqBhB,QAArB,EAA+BmB,uBAA/B,CAAX;AACAnB,YAAA,GAAWgB,oBAAA,CAAqBhB,QAArB,EAA+BoB,sBAA/B,CAAX;AAIA,QAAIC,0BAA0B,IAAIH,MAAJ,CAAW,qBAAX,EAAkC,GAAlC,CAA9B;AACAlB,YAAA,GAAWA,QAASY,CAAAA,OAAT,CAAiBS,uBAAjB,EAA0C,UAA1C,CAAX;AAIA,QAAIC,aAAa,IAAIJ,MAAJ,CAAW,OAAX,EAAoB,IAApB,CAAjB;AACAlB,YAAA,GAAWA,QAASY,CAAAA,OAAT,CAAiBU,UAAjB,EAA6B,EAA7B,CAAX;AAMA,QAAIC,iBAAiB,IAAIL,MAAJ,CAAW,iBAAX,EAA8B,GAA9B,CAArB;AACAlB,YAAA,GAAWS,oBAAA,CAAqBT,QAArB,EAA+BG,WAA/B,EAA4CoB,cAA5C,EAA4D,CAA5D,CAAX;AAGA,QAAIC,UAAU,IAAIN,MAAJ,CAAW,8BAAX,EAAwC,GAAxC,CAAd;AACAlB,YAAA,GAAWS,oBAAA,CAAqBT,QAArB,EAA+BG,WAA/B,EAA4CqB,OAA5C,EAAqD,CAArD,CAAX;AAGA,QAAIC,aAAa,IAAIP,MAAJ,CAAW,6BAAX,EAAuC,GAAvC,CAAjB;AACAlB,YAAA,GAAWS,oBAAA,CAAqBT,QAArB,EAA+BG,WAA/B,EAA4CsB,UAA5C,EAAwD,CAAxD,CAAX;AAGA,QAAIC,qBACA,gEADJ;AAEA1B,YAAA,GAAWS,oBAAA,CAAqBT,QAArB,EAA+BG,WAA/B,EAA4CuB,kBAA5C,EAAgE,CAAhE,CAAX;AASA,QAAIC,+BAA+B,uBAAnC;AACA3B,YAAA,GAAWS,oBAAA,CACPT,QADO,EACGG,WADH,EACgBwB,4BADhB,EAC8C,CAD9C,CAAX;AAGA,QAAIC,mBAAmB,qBAAvB;AACA5B,YAAA,GAAWS,oBAAA,CAAqBT,QAArB,EAA+BG,WAA/B,EAA4CyB,gBAA5C,EAA8D,CAA9D,CAAX;AAGA5B,YAAA,GAAWA,QAASY,CAAAA,OAAT,CAAiB,aAAjB,EAAgC,GAAhC,CAAX;AAIAZ,YAAA,GAAWA,QAASY,CAAAA,OAAT,CAAiB,QAAjB,EAA2B,GAA3B,CAAX;AAGA,QAAIiB,eAAe,oBAAnB;AACA7B,YAAA,GAAWS,oBAAA,CAAqBT,QAArB,EAA+BG,WAA/B,EAA4C0B,YAA5C,EAA0D,CAA1D,CAAX;AAEA,WAAO1B,WAAP;AAzEsC;AA4ExC2B,SAAA,GAAU,CACR/B,eAAgBA,cADR,CAAV;AA7JA,SAAA,OAAA;AAAA,CAAA,CAAA;;",
"sources":["goog/html/cssspecificity.js"],
"sourcesContent":["/**\n * @license\n * Copyright The Closure Library Authors.\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/** @fileoverview Calculator for specificity of CSS selectors. */\n\ngoog.module('goog.html.CssSpecificity');\ngoog.module.declareLegacyNamespace();\n\nvar userAgent = goog.require('goog.userAgent');\nvar userAgentProduct = goog.require('goog.userAgent.product');\n\n\n/**\n * Cached mapping from selectors to specificities.\n * @type {!Object<string, !Array<number>>}\n */\nvar specificityCache = {};\n\n/**\n * Calculates the specificity of CSS selectors, using a global cache if\n * supported.\n * @see http://www.w3.org/TR/css3-selectors/#specificity\n * @see https://specificity.keegan.st/\n * @param {string} selector The CSS selector.\n * @return {!Array<number>} The CSS specificity.\n * @supported IE9+, other browsers.\n */\nfunction getSpecificity(selector) {\n  if (userAgentProduct.IE && !userAgent.isVersionOrHigher(9)) {\n    // IE8 has buggy regex support.\n    return [0, 0, 0, 0];\n  }\n  var specificity = specificityCache.hasOwnProperty(selector) ?\n      specificityCache[selector] :\n      null;\n  if (specificity) {\n    return specificity;\n  }\n  if (Object.keys(specificityCache).length > (1 << 16)) {\n    // Limit the size of cache to (1 << 16) == 65536. Normally HTML pages don't\n    // have such numbers of selectors.\n    specificityCache = {};\n  }\n  specificity = calculateSpecificity(selector);\n  specificityCache[selector] = specificity;\n  return specificity;\n}\n\n/**\n * Find matches for a regular expression in the selector and increase count.\n * @param {string} selector The selector to match the regex with.\n * @param {!Array<number>} specificity The current specificity.\n * @param {!RegExp} regex The regular expression.\n * @param {number} typeIndex Index of type count.\n * @return {string}\n */\nfunction replaceWithEmptyText(selector, specificity, regex, typeIndex) {\n  return selector.replace(regex, function(match) {\n    specificity[typeIndex] += 1;\n    // Replace this simple selector with whitespace so it won't be counted\n    // in further simple selectors.\n    return Array(match.length + 1).join(' ');\n  });\n}\n\n/**\n * Replace escaped characters with plain text, using the \"A\" character.\n * @see https://www.w3.org/TR/CSS21/syndata.html#characters\n * @param {string} selector\n * @param {!RegExp} regex\n * @return {string}\n */\nfunction replaceWithPlainText(selector, regex) {\n  return selector.replace(regex, function(match) {\n    return Array(match.length + 1).join('A');\n  });\n}\n\n/**\n * Calculates the specificity of CSS selectors\n * @see http://www.w3.org/TR/css3-selectors/#specificity\n * @see https://github.com/keeganstreet/specificity\n * @see https://specificity.keegan.st/\n * @param {string} selector\n * @return {!Array<number>} The CSS specificity.\n */\nfunction calculateSpecificity(selector) {\n  var specificity = [0, 0, 0, 0];\n\n  // Cannot use RegExp literals for all regular expressions, IE does not accept\n  // the syntax.\n\n  // Matches a backslash followed by six hexadecimal digits followed by an\n  // optional single whitespace character.\n  var escapeHexadecimalRegex = new RegExp('\\\\\\\\[0-9A-Fa-f]{6}\\\\s?', 'g');\n  // Matches a backslash followed by fewer than six hexadecimal digits\n  // followed by a mandatory single whitespace character.\n  var escapeHexadecimalRegex2 = new RegExp('\\\\\\\\[0-9A-Fa-f]{1,5}\\\\s', 'g');\n  // Matches a backslash followed by any character\n  var escapeSpecialCharacter = /\\\\./g;\n  selector = replaceWithPlainText(selector, escapeHexadecimalRegex);\n  selector = replaceWithPlainText(selector, escapeHexadecimalRegex2);\n  selector = replaceWithPlainText(selector, escapeSpecialCharacter);\n\n  // Remove the negation pseudo-class (:not) but leave its argument because\n  // specificity is calculated on its argument.\n  var pseudoClassWithNotRegex = new RegExp(':not\\\\(([^\\\\)]*)\\\\)', 'g');\n  selector = selector.replace(pseudoClassWithNotRegex, '     $1 ');\n\n  // Remove anything after a left brace in case a user has pasted in a rule,\n  // not just a selector.\n  var rulesRegex = new RegExp('{[^]*', 'gm');\n  selector = selector.replace(rulesRegex, '');\n\n  // The following regular expressions assume that selectors matching the\n  // preceding regular expressions have been removed.\n\n  // SPECIFICITY 2: Counts attribute selectors.\n  var attributeRegex = new RegExp('(\\\\[[^\\\\]]+\\\\])', 'g');\n  selector = replaceWithEmptyText(selector, specificity, attributeRegex, 2);\n\n  // SPECIFICITY 1: Counts ID selectors.\n  var idRegex = new RegExp('(#[^\\\\#\\\\s\\\\+>~\\\\.\\\\[:]+)', 'g');\n  selector = replaceWithEmptyText(selector, specificity, idRegex, 1);\n\n  // SPECIFICITY 2: Counts class selectors.\n  var classRegex = new RegExp('(\\\\.[^\\\\s\\\\+>~\\\\.\\\\[:]+)', 'g');\n  selector = replaceWithEmptyText(selector, specificity, classRegex, 2);\n\n  // SPECIFICITY 3: Counts pseudo-element selectors.\n  var pseudoElementRegex =\n      /(::[^\\s\\+>~\\.\\[:]+|:first-line|:first-letter|:before|:after)/gi;\n  selector = replaceWithEmptyText(selector, specificity, pseudoElementRegex, 3);\n\n  // SPECIFICITY 2: Counts pseudo-class selectors.\n  // A regex for pseudo classes with brackets. For example:\n  //   :nth-child()\n  //   :nth-last-child()\n  //   :nth-of-type()\n  //   :nth-last-type()\n  //   :lang()\n  var pseudoClassWithBracketsRegex = /(:[\\w-]+\\([^\\)]*\\))/gi;\n  selector = replaceWithEmptyText(\n      selector, specificity, pseudoClassWithBracketsRegex, 2);\n  // A regex for other pseudo classes, which don't have brackets.\n  var pseudoClassRegex = /(:[^\\s\\+>~\\.\\[:]+)/g;\n  selector = replaceWithEmptyText(selector, specificity, pseudoClassRegex, 2);\n\n  // Remove universal selector and separator characters.\n  selector = selector.replace(/[\\*\\s\\+>~]/g, ' ');\n\n  // Remove any stray dots or hashes which aren't attached to words.\n  // These may be present if the user is live-editing this selector.\n  selector = selector.replace(/[#\\.]/g, ' ');\n\n  // SPECIFICITY 3: The only things left should be element selectors.\n  var elementRegex = /([^\\s\\+>~\\.\\[:]+)/g;\n  selector = replaceWithEmptyText(selector, specificity, elementRegex, 3);\n\n  return specificity;\n}\n\nexports = {\n  getSpecificity: getSpecificity\n};\n"],
"names":["goog","module","declareLegacyNamespace","userAgent","require","userAgentProduct","specificityCache","getSpecificity","selector","IE","isVersionOrHigher","specificity","hasOwnProperty","Object","keys","length","calculateSpecificity","replaceWithEmptyText","regex","typeIndex","replace","match","Array","join","replaceWithPlainText","escapeHexadecimalRegex","RegExp","escapeHexadecimalRegex2","escapeSpecialCharacter","pseudoClassWithNotRegex","rulesRegex","attributeRegex","idRegex","classRegex","pseudoElementRegex","pseudoClassWithBracketsRegex","pseudoClassRegex","elementRegex","exports"]
}
